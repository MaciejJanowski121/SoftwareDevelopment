{"ast":null,"code":"var _jsxFileName = \"/Users/maciejjanowski/Desktop/reservationSystem/frontend/src/components/ReservationForm.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useMemo, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ReservationForm({\n  setReservation\n}) {\n  _s();\n  // stałe\n  const OPEN_HOUR = 12;\n  const CLOSE_HOUR = 22; // lokal do 22:00 → start tylko 12..21\n  const MIN_MIN = 30;\n  const MAX_MIN = 300;\n  const navigate = useNavigate();\n  const API = useMemo(() => process.env.REACT_APP_API_URL || \"http://localhost:8080\", []);\n\n  // stan\n  const [dateStr, setDateStr] = useState(() => new Date().toISOString().slice(0, 10));\n  const [hour, setHour] = useState(18); // number input -> strzałki ▲▼\n  const [minute, setMinute] = useState(\"00\"); // \"00\" | \"30\"\n  const [duration, setDuration] = useState(120); // 30..300 co 30\n  const [tableNumber, setTableNumber] = useState(\"\");\n  const [availableTables, setAvailableTables] = useState([]);\n  const [loadingTables, setLoadingTables] = useState(false);\n  const [formError, setFormError] = useState(\"\");\n  const [fetchKey, setFetchKey] = useState(\"\"); // do prostego debounce\n\n  // pomocnicze mini-funkcje (lokalnie, bez importów)\n  const pad = n => n < 10 ? `0${n}` : `${n}`;\n  const toIsoWithSeconds = d => `${d.getFullYear()}-${pad(d.getMonth() + 1)}-${pad(d.getDate())}T${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;\n  const start = useMemo(() => {\n    if (!dateStr) return null;\n    return new Date(`${dateStr}T${pad(hour)}:${minute}:00`);\n  }, [dateStr, hour, minute]);\n  const maxAllowed = useMemo(() => {\n    if (!start) return MAX_MIN;\n    const latestEnd = new Date(start);\n    latestEnd.setHours(CLOSE_HOUR, 0, 0, 0);\n    const diff = Math.floor((latestEnd - start) / 60000);\n    if (diff <= 0) return 0;\n    return Math.min(diff, MAX_MIN);\n  }, [start]);\n  const end = useMemo(() => start ? new Date(start.getTime() + duration * 60000) : null, [start, duration]);\n\n  // pilnuj, żeby nie dało się wybrać 22 jako godziny startu\n  useEffect(() => {\n    if (hour >= CLOSE_HOUR) setHour(CLOSE_HOUR - 1);\n  }, [hour]);\n\n  // prościutki debounce: za każdym razem, gdy zmieni się start/duration, ustawiamy klucz\n  useEffect(() => {\n    const t = setTimeout(() => {\n      if (start && duration) setFetchKey(`${start.getTime()}|${duration}`);\n    }, 350);\n    return () => clearTimeout(t);\n  }, [start === null || start === void 0 ? void 0 : start.getTime(), duration]);\n\n  // pobieranie dostępnych stolików (kiedy fetchKey się zmieni)\n  useEffect(() => {\n    if (!fetchKey) return;\n    // nie wykraczamy poza 22:00\n    if (maxAllowed < MIN_MIN) {\n      setAvailableTables([]);\n      return;\n    }\n    const controller = new AbortController();\n    (async () => {\n      setLoadingTables(true);\n      try {\n        const res = await fetch(`${API}/api/reservations/available?start=${encodeURIComponent(toIsoWithSeconds(start))}&minutes=${duration}`, {\n          credentials: \"include\",\n          signal: controller.signal\n        });\n        const json = res.ok ? await res.json() : [];\n        setAvailableTables(Array.isArray(json) ? json : []);\n      } catch {\n        setAvailableTables([]);\n      } finally {\n        setLoadingTables(false);\n      }\n    })();\n    return () => controller.abort();\n  }, [API, fetchKey, maxAllowed, duration, start]);\n\n  // jeśli wybrany stolik zniknie z listy — reset\n  useEffect(() => {\n    if (tableNumber && !availableTables.some(t => String(t.tableNumber) === String(tableNumber))) {\n      setTableNumber(\"\");\n    }\n  }, [availableTables, tableNumber]);\n\n  // walidacja\n  function validate() {\n    if (!start) return \"Bitte Startzeit auswählen.\";\n    if (start < new Date()) return \"Reservierungen in der Vergangenheit sind nicht möglich.\";\n    if (duration < MIN_MIN || duration > MAX_MIN) return \"Die Dauer muss zwischen 30 und 300 Minuten liegen.\";\n    if (maxAllowed < MIN_MIN) return \"Die letzte Reservierung muss spätestens um 22:00 Uhr enden. Bitte frühere Zeit wählen.\";\n    if (duration > maxAllowed) return `Für diese Startzeit ist maximal ${maxAllowed} Minuten erlaubt (bis 22:00 Uhr).`;\n    if (!tableNumber) return \"Bitte Tisch auswählen.\";\n    return null;\n  }\n  async function handleSubmit(e) {\n    e.preventDefault();\n    setFormError(\"\");\n    const err = validate();\n    if (err) return setFormError(err);\n    const resp = await fetch(`${API}/api/reservations`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      credentials: \"include\",\n      body: JSON.stringify({\n        tableNumber: Number(tableNumber),\n        startTime: toIsoWithSeconds(start),\n        endTime: toIsoWithSeconds(end)\n      })\n    });\n    const text = await resp.text();\n    if (!resp.ok) return setFormError(text || \"Reservierung fehlgeschlagen.\");\n    const data = text ? JSON.parse(text) : null;\n    setReservation([data]);\n    navigate(\"/reservations/my\");\n  }\n  const todayStr = useMemo(() => new Date().toISOString().slice(0, 10), []);\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    noValidate: true,\n    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n      htmlFor: \"date\",\n      children: \"Datum\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      id: \"date\",\n      type: \"date\",\n      value: dateStr,\n      min: todayStr,\n      onChange: e => {\n        setDateStr(e.target.value);\n        setFormError(\"\");\n      },\n      required: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      style: {\n        display: \"block\",\n        marginTop: 8\n      },\n      children: \"Uhrzeit\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        min: OPEN_HOUR,\n        max: CLOSE_HOUR - 1 // 21\n        ,\n        step: 1,\n        value: hour,\n        onChange: e => setHour(Math.max(OPEN_HOUR, Math.min(CLOSE_HOUR - 1, Number(e.target.value) || OPEN_HOUR))),\n        \"aria-label\": \"Stunde\",\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 17\n      }, this), \":\", /*#__PURE__*/_jsxDEV(\"select\", {\n        value: minute,\n        onChange: e => setMinute(e.target.value),\n        \"aria-label\": \"Minute\",\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"00\",\n          children: \"00\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"30\",\n          children: \"30\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      id: \"startTime\",\n      type: \"hidden\",\n      value: start ? `${dateStr}T${pad(hour)}:${minute}` : \"\",\n      readOnly: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      htmlFor: \"duration\",\n      style: {\n        display: \"block\",\n        marginTop: 8\n      },\n      children: \"Dauer\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n      id: \"duration\",\n      value: duration,\n      onChange: e => setDuration(Number(e.target.value)),\n      required: true,\n      children: Array.from({\n        length: (MAX_MIN - MIN_MIN) / 30 + 1\n      }, (_, i) => {\n        const m = MIN_MIN + i * 30; // 30, 60, 90…\n        const disabled = start && m > maxAllowed;\n        const label = m < 60 ? `${m} Min` : `${Math.floor(m / 60)} Std${m % 60 ? ` ${m % 60} Min` : \"\"}`;\n        return /*#__PURE__*/_jsxDEV(\"option\", {\n          value: m,\n          disabled: disabled,\n          children: [label, disabled ? \" (bis 22:00 Uhr)\" : \"\"]\n        }, m, true, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 25\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      htmlFor: \"tableNumber\",\n      style: {\n        display: \"block\",\n        marginTop: 8\n      },\n      children: \"Tisch\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n      id: \"tableNumber\",\n      value: tableNumber,\n      onChange: e => setTableNumber(e.target.value),\n      required: true,\n      disabled: loadingTables || maxAllowed < MIN_MIN,\n      children: [/*#__PURE__*/_jsxDEV(\"option\", {\n        value: \"\",\n        children: loadingTables ? \"Lade…\" : \"Tisch auswählen…\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 17\n      }, this), availableTables.map(t => /*#__PURE__*/_jsxDEV(\"option\", {\n        value: t.tableNumber,\n        children: [\"Tisch \", t.tableNumber, \" (\", t.numberOfSeats, \" Pers.)\"]\n      }, t.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 21\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 13\n    }, this), end && /*#__PURE__*/_jsxDEV(\"small\", {\n      children: [\"Ende: \", end.toLocaleTimeString(\"de-DE\", {\n        hour: \"2-digit\",\n        minute: \"2-digit\"\n      }), \" (sp\\xE4testens 22:00 Uhr)\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 17\n    }, this), formError && /*#__PURE__*/_jsxDEV(\"p\", {\n      \"data-cy\": \"form-error\",\n      style: {\n        color: \"#c62828\"\n      },\n      children: formError\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      style: {\n        display: \"block\",\n        marginTop: 10\n      },\n      disabled: maxAllowed < MIN_MIN,\n      children: \"Reservieren\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 146,\n    columnNumber: 9\n  }, this);\n}\n_s(ReservationForm, \"8AuaL0jioBixysqcRez6+Ro7I5Q=\", false, function () {\n  return [useNavigate];\n});\n_c = ReservationForm;\nvar _c;\n$RefreshReg$(_c, \"ReservationForm\");","map":{"version":3,"names":["useEffect","useMemo","useState","useNavigate","jsxDEV","_jsxDEV","ReservationForm","setReservation","_s","OPEN_HOUR","CLOSE_HOUR","MIN_MIN","MAX_MIN","navigate","API","process","env","REACT_APP_API_URL","dateStr","setDateStr","Date","toISOString","slice","hour","setHour","minute","setMinute","duration","setDuration","tableNumber","setTableNumber","availableTables","setAvailableTables","loadingTables","setLoadingTables","formError","setFormError","fetchKey","setFetchKey","pad","n","toIsoWithSeconds","d","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","start","maxAllowed","latestEnd","setHours","diff","Math","floor","min","end","getTime","t","setTimeout","clearTimeout","controller","AbortController","res","fetch","encodeURIComponent","credentials","signal","json","ok","Array","isArray","abort","some","String","validate","handleSubmit","e","preventDefault","err","resp","method","headers","body","JSON","stringify","Number","startTime","endTime","text","data","parse","todayStr","onSubmit","noValidate","children","htmlFor","fileName","_jsxFileName","lineNumber","columnNumber","id","type","value","onChange","target","required","style","display","marginTop","max","step","readOnly","from","length","_","i","m","disabled","label","map","numberOfSeats","toLocaleTimeString","color","_c","$RefreshReg$"],"sources":["/Users/maciejjanowski/Desktop/reservationSystem/frontend/src/components/ReservationForm.jsx"],"sourcesContent":["import { useEffect, useMemo, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\n\nexport default function ReservationForm({ setReservation }) {\n    // stałe\n    const OPEN_HOUR = 12;\n    const CLOSE_HOUR = 22; // lokal do 22:00 → start tylko 12..21\n    const MIN_MIN = 30;\n    const MAX_MIN = 300;\n\n    const navigate = useNavigate();\n    const API = useMemo(\n        () => process.env.REACT_APP_API_URL || \"http://localhost:8080\",\n        []\n    );\n\n    // stan\n    const [dateStr, setDateStr] = useState(() => new Date().toISOString().slice(0, 10));\n    const [hour, setHour] = useState(18);          // number input -> strzałki ▲▼\n    const [minute, setMinute] = useState(\"00\");    // \"00\" | \"30\"\n    const [duration, setDuration] = useState(120); // 30..300 co 30\n    const [tableNumber, setTableNumber] = useState(\"\");\n    const [availableTables, setAvailableTables] = useState([]);\n    const [loadingTables, setLoadingTables] = useState(false);\n    const [formError, setFormError] = useState(\"\");\n    const [fetchKey, setFetchKey] = useState(\"\");  // do prostego debounce\n\n    // pomocnicze mini-funkcje (lokalnie, bez importów)\n    const pad = (n) => (n < 10 ? `0${n}` : `${n}`);\n    const toIsoWithSeconds = (d) =>\n        `${d.getFullYear()}-${pad(d.getMonth() + 1)}-${pad(d.getDate())}T${pad(\n            d.getHours()\n        )}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;\n\n    const start = useMemo(() => {\n        if (!dateStr) return null;\n        return new Date(`${dateStr}T${pad(hour)}:${minute}:00`);\n    }, [dateStr, hour, minute]);\n\n    const maxAllowed = useMemo(() => {\n        if (!start) return MAX_MIN;\n        const latestEnd = new Date(start);\n        latestEnd.setHours(CLOSE_HOUR, 0, 0, 0);\n        const diff = Math.floor((latestEnd - start) / 60000);\n        if (diff <= 0) return 0;\n        return Math.min(diff, MAX_MIN);\n    }, [start]);\n\n    const end = useMemo(\n        () => (start ? new Date(start.getTime() + duration * 60000) : null),\n        [start, duration]\n    );\n\n    // pilnuj, żeby nie dało się wybrać 22 jako godziny startu\n    useEffect(() => {\n        if (hour >= CLOSE_HOUR) setHour(CLOSE_HOUR - 1);\n    }, [hour]);\n\n    // prościutki debounce: za każdym razem, gdy zmieni się start/duration, ustawiamy klucz\n    useEffect(() => {\n        const t = setTimeout(() => {\n            if (start && duration) setFetchKey(`${start.getTime()}|${duration}`);\n        }, 350);\n        return () => clearTimeout(t);\n    }, [start?.getTime(), duration]);\n\n    // pobieranie dostępnych stolików (kiedy fetchKey się zmieni)\n    useEffect(() => {\n        if (!fetchKey) return;\n        // nie wykraczamy poza 22:00\n        if (maxAllowed < MIN_MIN) {\n            setAvailableTables([]);\n            return;\n        }\n\n        const controller = new AbortController();\n        (async () => {\n            setLoadingTables(true);\n            try {\n                const res = await fetch(\n                    `${API}/api/reservations/available?start=${encodeURIComponent(\n                        toIsoWithSeconds(start)\n                    )}&minutes=${duration}`,\n                    { credentials: \"include\", signal: controller.signal }\n                );\n                const json = res.ok ? await res.json() : [];\n                setAvailableTables(Array.isArray(json) ? json : []);\n            } catch {\n                setAvailableTables([]);\n            } finally {\n                setLoadingTables(false);\n            }\n        })();\n        return () => controller.abort();\n    }, [API, fetchKey, maxAllowed, duration, start]);\n\n    // jeśli wybrany stolik zniknie z listy — reset\n    useEffect(() => {\n        if (tableNumber && !availableTables.some((t) => String(t.tableNumber) === String(tableNumber))) {\n            setTableNumber(\"\");\n        }\n    }, [availableTables, tableNumber]);\n\n    // walidacja\n    function validate() {\n        if (!start) return \"Bitte Startzeit auswählen.\";\n        if (start < new Date()) return \"Reservierungen in der Vergangenheit sind nicht möglich.\";\n        if (duration < MIN_MIN || duration > MAX_MIN)\n            return \"Die Dauer muss zwischen 30 und 300 Minuten liegen.\";\n        if (maxAllowed < MIN_MIN)\n            return \"Die letzte Reservierung muss spätestens um 22:00 Uhr enden. Bitte frühere Zeit wählen.\";\n        if (duration > maxAllowed)\n            return `Für diese Startzeit ist maximal ${maxAllowed} Minuten erlaubt (bis 22:00 Uhr).`;\n        if (!tableNumber) return \"Bitte Tisch auswählen.\";\n        return null;\n    }\n\n    async function handleSubmit(e) {\n        e.preventDefault();\n        setFormError(\"\");\n        const err = validate();\n        if (err) return setFormError(err);\n\n        const resp = await fetch(`${API}/api/reservations`, {\n            method: \"POST\",\n            headers: { \"Content-Type\": \"application/json\" },\n            credentials: \"include\",\n            body: JSON.stringify({\n                tableNumber: Number(tableNumber),\n                startTime: toIsoWithSeconds(start),\n                endTime: toIsoWithSeconds(end),\n            }),\n        });\n\n        const text = await resp.text();\n        if (!resp.ok) return setFormError(text || \"Reservierung fehlgeschlagen.\");\n\n        const data = text ? JSON.parse(text) : null;\n        setReservation([data]);\n        navigate(\"/reservations/my\");\n    }\n\n    const todayStr = useMemo(() => new Date().toISOString().slice(0, 10), []);\n\n    return (\n        <form onSubmit={handleSubmit} noValidate>\n            {/* Data */}\n            <label htmlFor=\"date\">Datum</label>\n            <input\n                id=\"date\"\n                type=\"date\"\n                value={dateStr}\n                min={todayStr}\n                onChange={(e) => {\n                    setDateStr(e.target.value);\n                    setFormError(\"\");\n                }}\n                required\n            />\n\n            {/* Godzina */}\n            <label style={{ display: \"block\", marginTop: 8 }}>Uhrzeit</label>\n            <div>\n                <input\n                    type=\"number\"\n                    min={OPEN_HOUR}\n                    max={CLOSE_HOUR - 1} // 21\n                    step={1}\n                    value={hour}\n                    onChange={(e) => setHour(Math.max(OPEN_HOUR, Math.min(CLOSE_HOUR - 1, Number(e.target.value) || OPEN_HOUR)))}\n                    aria-label=\"Stunde\"\n                    required\n                />\n                :\n                <select\n                    value={minute}\n                    onChange={(e) => setMinute(e.target.value)}\n                    aria-label=\"Minute\"\n                >\n                    <option value=\"00\">00</option>\n                    <option value=\"30\">30</option>\n                </select>\n            </div>\n\n            {/* Hidden dla Cypress (np. #startTime) */}\n            <input\n                id=\"startTime\"\n                type=\"hidden\"\n                value={start ? `${dateStr}T${pad(hour)}:${minute}` : \"\"}\n                readOnly\n            />\n\n            {/* Czas trwania */}\n            <label htmlFor=\"duration\" style={{ display: \"block\", marginTop: 8 }}>\n                Dauer\n            </label>\n            <select\n                id=\"duration\"\n                value={duration}\n                onChange={(e) => setDuration(Number(e.target.value))}\n                required\n            >\n                {Array.from({ length: (MAX_MIN - MIN_MIN) / 30 + 1 }, (_, i) => {\n                    const m = MIN_MIN + i * 30; // 30, 60, 90…\n                    const disabled = start && m > maxAllowed;\n                    const label = m < 60 ? `${m} Min` : `${Math.floor(m / 60)} Std${m % 60 ? ` ${m % 60} Min` : \"\"}`;\n                    return (\n                        <option key={m} value={m} disabled={disabled}>\n                            {label}{disabled ? \" (bis 22:00 Uhr)\" : \"\"}\n                        </option>\n                    );\n                })}\n            </select>\n\n            {/* Wybór stolika */}\n            <label htmlFor=\"tableNumber\" style={{ display: \"block\", marginTop: 8 }}>\n                Tisch\n            </label>\n            <select\n                id=\"tableNumber\"\n                value={tableNumber}\n                onChange={(e) => setTableNumber(e.target.value)}\n                required\n                disabled={loadingTables || maxAllowed < MIN_MIN}\n            >\n                <option value=\"\">{loadingTables ? \"Lade…\" : \"Tisch auswählen…\"}</option>\n                {availableTables.map((t) => (\n                    <option key={t.id} value={t.tableNumber}>\n                        Tisch {t.tableNumber} ({t.numberOfSeats} Pers.)\n                    </option>\n                ))}\n            </select>\n\n            {/* Podgląd końca */}\n            {end && (\n                <small>\n                    Ende: {end.toLocaleTimeString(\"de-DE\", { hour: \"2-digit\", minute: \"2-digit\" })} (spätestens 22:00 Uhr)\n                </small>\n            )}\n\n            {/* Błąd */}\n            {formError && (\n                <p data-cy=\"form-error\" style={{ color: \"#c62828\" }}>\n                    {formError}\n                </p>\n            )}\n\n            <button type=\"submit\" style={{ display: \"block\", marginTop: 10 }} disabled={maxAllowed < MIN_MIN}>\n                Reservieren\n            </button>\n        </form>\n    );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}